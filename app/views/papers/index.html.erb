<div>
  <div>
    <h1>
      Your saved arXiv papers
    </h1>
  </div>
</div>

<hr>

<div>
  <div>
    <h2>
      Add a new paper
    </h2>

    <form action="/insert_paper" method="post" enctype="multipart/form-data">
      <div>
        <label for="title_box">
          Title
        </label>

        <input type="text" id="title_box" name="query_title">
      </div>

      <div>
        <label for="author_box">
          Author
        </label>

        <input type="text" id="author_box" name="query_author">
      </div>

      <div>
        <label for="arxiv_identifier_box">
          Arxiv identifier
        </label>

        <input type="text" id="arxiv_identifier_box" name="query_arxiv_identifier">
      </div>

      <div>
        <label for="url_box">
          Url
        </label>

        <input type="text" id="url_box" name="query_url">
      </div>

      <div>
        <label for="text_box">
          Text
        </label>

        <input type="file" id="text_box" name="query_text" class="form-control">
      </div>

      <div>
        <label for="topics_box">Select Topics</label><br>
        <% Topic.all.each do |topic| %>
          <input type="checkbox" name="topic_ids[]" value="<%= topic.id %>">
          <%= topic.topic %><br>
        <% end %>
      </div>

      <button>
        Add paper
      </button>
    </form>

    <h3>
      Don't see a relevant topic? Quickly add it here or 
      <a href="/topics">go to Topics</a>
    </h3>
    <form action="/insert_topic" method="post">
      <div>
        <label for="topic_box">New Topic</label>
        <input type="text" id="topic_box" name="query_topic">
      </div>
      <button>Create Topic</button>
    </form>
  </div>
</div>
<hr>

<h2>Filter by Topics</h2>
<form action="/papers" method="get">
  <% Topic.all.each do |topic| %>
    <input type="checkbox" name="topic_ids[]" value="<%= topic.id %>" <%= params[:topic_ids]&.include?(topic.id.to_s) ? 'checked' : '' %>>
    <%= topic.topic %><br>
  <% end %>
  <button>Filter</button>
</form>
<%= link_to "Show All Papers", papers_path %>

<hr>
<div>
  <div>
    <table border="1">
      <tr>
        <th>
          ID
        </th>

        <th>
          Title
        </th>

        <th>
          Author
        </th>

        <th>
          Arxiv identifier
        </th>

        <th>
          Url
        </th>

        <th>
          Text
        </th>

        <th>
          Created at
        </th>

        <th>
          Updated at
        </th>

        <th>
        </th>
      </tr>

      <% @list_of_papers.each do |a_paper| %>
      <tr>
        <td>
          <%= a_paper.id %>
        </td>

        <td>
          <%= a_paper.title %>
        </td>

        <td>
          <%= a_paper.author %>
        </td>

        <td>
          <%= a_paper.arxiv_identifier %>
        </td>

        <td>
          <% if a_paper.url.present? %>
            <a href="<%= a_paper.url %>" target="_blank"><%= a_paper.url %></a>
          <% else %>
            No URL provided
          <% end %>
        </td>

        <td>
          <% if a_paper.text.present? %>
            <a href="<%= a_paper.text.url %>" target="_blank">Download</a>
          <% else %>
            No file uploaded
          <% end %>
        </td>

        <td>
          <%= time_ago_in_words(a_paper.created_at) %> ago
        </td>
        <td>
          <%= time_ago_in_words(a_paper.updated_at) %> ago
        </td>

        <td>
          <a href="/papers/<%= a_paper.id %>">
            Show details
          </a>
        </td>
      </tr>
      <% end %>
    </table>
  </div>
</div>

<hr>
